<!DOCTYPE html>
<html>
<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

<style>
p {
  display: inline-block;
  font-size: 35px;
  padding: 20px;
  margin: 0;
  color: white;
}


body {background-color: black;}

.button {
  display: inline-block;
  padding: 2px 50px 2px 50px;
  margin: 20px;
  font-size: 70px;
  cursor: pointer;
  text-align: center;
  text-decoration: none;
  outline: none;
  color: #fff;
  background-color: #4CAF50;
  border: none;
  border-radius: 15px;
  box-shadow: 0 9px #999;
}

.button:active {
  background-color: blue;
  box-shadow: 0 5px #666;
  transform: translateY(4px);
}

.orologio{
  display: inline-block;
  font-size: 70px;
  padding: 10px;
  margin: 0;
  text-align: center;
  margin-left: 200px !important;
  color: yellow;
  font-weight: bold;
}

.minus{
  display: inline-block;
  padding: 2px 50px 2px 50px;
  margin: 20px;
  font-size: 70px;
  cursor: pointer;
  text-align: center;
  text-decoration: none;
  outline: none;
  color: #fff;
  background-color: red;
  border: none;
  border-radius: 15px;
  box-shadow: 0 9px #999;
}

.minus:active {
  background-color: orange;
  box-shadow: 0 5px #666;
  transform: translateY(4px);
}
</style>
<body>


<body onload="getLocation()">
<div class="orologio" id="orologio"></div>

<div id='container'>
  <p id="demo"></p>
  <p id="tidedata"></p>
</div>
<button class="button, minus" onclick="getLocation()">click to RESET </button>
<script>
function checkTime(i) {
    if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
    return i;
}
function startTime() {
  var weekday=["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]
    var today = new Date();
    var h = today.getHours();
    var m = today.getMinutes();
    var s = today.getSeconds();
    var d = weekday[today.getDay()];
    m = checkTime(m);
    s = checkTime(s);
    document.getElementById('orologio').innerHTML =
    h + ":" + m + ":" + s;
    var t = setTimeout(startTime, 500);
}

function getLocation() {
  startTime();
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else { 
    document.getElementById("demo").innerHTML = "Geolocation is not supported by this browser.";
  }
}


function showPosition(position) {
 console.log("Latitude: " + position.coords.latitude + " Longitude: " + position.coords.longitude)
 console.log("https://tides.p.rapidapi.com/tides?latitude="+position.coords.latitude+"&longitude="+position.coords.longitude+"&duration=1440&interval=60")
  settings = {
    "async": true,
    "crossDomain": true,
    "url": "https://tides.p.rapidapi.com/tides?latitude="+position.coords.latitude+"&longitude="+position.coords.longitude+"&duration=1440&interval=60",
    "method": "GET",
    "headers": {
      "x-rapidapi-key": "fbf93a6482mshd1b9ac4b389f5d3p195c26jsn2d4bc217232b",
      "x-rapidapi-host": "tides.p.rapidapi.com"
    }
  }

  $.ajax(settings).done(function (response) {
    console.log(response);
    data = response.extremes.map(x => [x.datetime.slice(11,16) + " " + x.state.split(/\s+/)[0] + " " + x.height.toFixed(2)] + " m")
    // document.getElementById("tidedata").innerHTML = data.join("\n")
    let list = document.getElementById("tidedata");
    data.forEach((item)=>{
      let li = document.createElement("li");
      li.innerText = item;
      list.appendChild(li);
    })
  });

  document.getElementById("demo").innerHTML = position.coords.latitude.toFixed(3) + ", " + position.coords.longitude.toFixed(3)
}

</script>

</body>
</html>